# 자바 8과 함수형 프로그래밍 개론(Java 8 with Functional Programming)
*시작에 앞서, 이 글은 책, 강의, 구글링등을 통해 개인적으로 학습 및 실습한 개념을 정리한 글이며, 정확하지 않은 내용이 있을 수 있습니다. 꾸준히 공부해가며 수정하겠습니다. 또한, 오류 지적은 언제나 환영입니다.*

## 개요
이 글은 자바 8의 세 가지 핵심적인 변화를 함수형 프로그래밍의 관점에서 다룬다. 쉽게 말해 **동작 파라미터화(메소드 참조, 람다), 스트림 API, 병렬성을 함수형 프로그래밍과** 함께 살펴볼 것이다.

글의 영제에서도 알 수 있듯이 이 글은 함수형 프로그래밍보다는 자바 8을 집중적으로 다루었다. 하지만, 앞서 언급한 자바 8의 변화는 함수형 프로그래밍의 핵심적인 사항과 깊게 연관되어 있어 둘을 떼어놓고 설명한다면 이는 반쪽짜리가 되어버린다. 따라서, 함수형 프로그래밍의 핵심 개념과 연관지어 자바 8을 살펴볼 것이다. 전체 글의 구성은 다음과 같다.

* (0) 개론
* (1) 동적 파라미터화; 메소드 참조와 람다
* (2) 스트림 API
* (3) 멀티코어 병렬성

개론 부분에서는 함수형 프로그래밍을 중심으로 하여 **자바는 왜 자바 8과 같이 변화했는가(변화할 수 밖에 없었는가)**에 대해 알아본다. 1편 동적 파라미터화에서는 메소드 참조와 람다를 중심으로 동적 파라미터화를 다룬다. 2편은 스트림 API, 3편은 멀티코어 병렬성과 공유 가변 데이터를 중점적으로 다룬다.

## 자바는 왜 자바 8과 같이 변화했는가
먼저 *자바는 아니, 프로그래밍 언어는 왜 계속해서 변화할 수 밖에 없을까?* 라는 당연한 질문에 대한 답을 생각해보자. 당연히 **언어의 생존**을 위해서다. 과거부터 지금까지 수천 개의 프로그래밍 언어가 쏟아져 나왔다. 개발 트렌드(=프로그래머들의 다양한 요구)에 따라 새로운 언어가 등장했고, 이를 만족하지 못하는 기존 언어는 사장되었다. 이러한 프로그래밍 언어의 역사는 생태계에 비유될 수 있다. 즉, **변화하는 환경에 적응하지 못한 언어는 시장에서 도태**된다는 뜻이다. 자바는 1995년 첫 베타 버전이 공개되었고, 지금까지도 시장에서 가장 대중적인 프로그래밍 언어 중 하나로 꼽힌다. 이는 자바가 꽤 오랜 기간동안 빠르게 변화하는 환경과 요구에 맞춰 성공적으로 발전해왔음을 의미한다. 자바 역사를 통틀어 자바 8에서 가장 큰 변화가 일어났다고 해도 과언이 아니다.

자바 8의 가장 큰 변화는 기존 값을 변화시키는 데 집중했던 고전적인 객체지향에서 벗어나 **함수형 프로그래밍의 핵심 개념을 도입**했다는 것이다. 고전적인 객체지향과 함수형 프로그래밍은 서로 다른 방향을 지향하지만, **자바 8에서는 고전적인 객체지향을 바탕으로 함수형 프로그래밍까지 흡수**하여 두 가지 프로그래밍 패러다임의 장점을 모두 활용할 수 있게 했다.

물론 이러한 변화는 합당한 배경을 갖는다. 자바 8의 변화는 **간결한 코드, 멀티코어 프로세서의 쉬운 활용**에 대한 니즈에 의해 야기되었다. 자바 8은 보다 다양한 프로그래밍 문제를 더 빠르고 정확하며 쉽게 유지보수할 수 있다는 장점을 제공한다. 자바 8에 추가된 기능은 기존 자바에 존재하지 않던 새로운 개념이지만 현재 시장에서 요구하는 기능을 효과적으로 제공한다. 참고로, 자바 8에서 새롭게 추가된 기능들은 이러한 기능에 대한 니즈가 존재함을 명확하게 인지했던 때를 지나 이러한 니즈를 반영한 다른 프로그래밍 언어의 효용성이 증명된 이후 도입되었다.

## 함수형 프로그래밍
많은 프로그래머는 코드 크래시 디버깅 문제를 가장 많이 겪게 된다. 코드 크래시는 예상치 못한 변숫값 때문에 발생할 수 있다. 이때 SW의 규모가 클수록 이 변숫값의 변화에 대한 원인을 규명하기 힘들다. 규모가 크지않더라도 유지보수 중 이런 일이 얼마나 자주 일어나는지 생각해보라. 함수형 프로그래밍의 side effect free함과 불변성(immutability)라는 개념이 이를 해결하는 데 큰 도움이 될 것이다.

### 함수형 프로그래밍이 뭘까?
함수형 프로그래밍은 **함수를 이용하는 프로그래밍**이다..!!

#### 함수형 프로그래밍의 함수
은 아니고, 여기서 함수란 무엇을 의미할까? 이에 답하기 앞서, 순수 함수(pure function)에 대해 알아보자. 명령형 프로그래밍의 기존 메소드와 비교하여 순수 함수에 대해 알아보도록 하겠다. 먼저, 기존의 메소드는 다음과 같다.

![](https://images.velog.io/images/harang/post/44292d51-bd3d-46f8-bc6a-b517425790ad/conventional%20method.png)

위와 같이 메소드는 순수하게 입력에 대한 출력을 계산을 수행하는 것 이외의 동작(부작용, Side Effect)를 발생시킨다. 이러한 부작용은 프로그램에 영향을 주며, 그 예로는 본인(인스턴스)의 필드 값을 변경하는 동작, 다른 인스턴스의 필드 값을 변경하는 동작등이 있겠다.  이는 프로그래머로 하여금 예상치 못한 에러의 원인을 파악하기 힘들게 만든다.

![](https://images.velog.io/images/harang/post/f55d84bb-87b2-4f05-b344-3398ed94bf82/pure%20function.png)

하지만, 순수 함수의 경우 다음과 같이 순수하게 입력에 대한 출력 값을 계산하는 동작만을 수행하며, 어떠한 부작용도 포함하지 않는다. 수학적인 개념의 함수를 떠올리면 이해하기 쉬울 것이다. 

자 이제 함수형 프로그래밍에서 쓰이는 함수를 정의해보자. 이는 다음과 같은 조건을 만족한다.
* 동일한 입력(Argument)에 대해서 항상 같은 출력 값을 반환한다(**Same input, same output**).
* 함수의 실행은 **프로그램에 영향을 끼치는 어떠한 부작용(Side Effect)도 동반하지 않는다.**
  * 이때 명심해야할 점은 함수형 프로그래밍에서의 함수는 순수 함수와는 다르게 프로그램의 다른 부분에 영향을 미치지 않는다면, 내부적으로는 함수형이 아닌 기능을 포함할 수 있다. 즉, **실질적으로 부작용을 동반하여도, 아무도 이로 인한 영향을 받지 않게 설계함으로써 함수형을 달성**할 수 있다.
  
위와 같은 정의를 사용하여 다시 한번 조금 더 친절하게 함수형 프로그래밍을 설명하면, 시스템의 다른 부분에 영향을 미치지 않는다면 내부적으로는 순수 함수형이 아닌 기능도 사용하는 방식을 함수형 프로그래밍이라 한다!


## Reference
* 윤성우의 열혈 Java 프로그래밍(윤성우, 오렌지 미디어, 2017)
* 모던 자바 인 액션(라울-게이브리얼 우르마 외2명, 우정은, 한빛미디어, 2019)